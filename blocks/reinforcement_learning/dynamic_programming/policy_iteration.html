<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="content-security-policy" content="">
		<link href="../../../_app/immutable/assets/_layout.1428866a.css" rel="stylesheet">
		<link href="../../../_app/immutable/assets/_layout.c302c1ba.css" rel="stylesheet">
		<link href="../../../_app/immutable/assets/Block.5196796e.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.0686d7cc.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.4d92b023.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.b5fab157.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.e1ba4c1e.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.bbaaaf6b.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/_layout.svelte.cd4aa2d6.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Icon.8b13d35a.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/_layout.js.984db11e.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/_layout.da46b06b.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/blocks-(blocks)-layout.svelte.8aefdd09.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/stores.ead570af.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/arrow-right-circle.181d46af.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/blocks-(blocks)-layout.js.b7894951.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/_layout.02aace96.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/blocks-(blocks)-reinforcement_learning-dynamic_programming-policy_iteration-page.svelte.d06aea53.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Container.b0705c7b.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Latex.e0b308c0.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/maps.0f079072.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/SvgContainer.f70b5745.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/color.667ef569.js"><title>World4AI | Reinforcement Learning | Policy Iteration Algorithm</title><!-- HEAD_svelte-1rhre4_START --><meta name="description" content="Policy iteration is an iterative (dynamic programming) algorithm. The algorithm alternates between policy evaluation and policy improvement to arrive at the optimal policy and value functions"><!-- HEAD_svelte-1rhre4_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END --><!-- HEAD_svelte-a6me6e_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><!-- HEAD_svelte-a6me6e_END -->
  </head>
  <body>
    <div id="svelte">


<header class="sticky top-0 left-0 w-full z-50 select-none py-2 bg-white border-b"><div class="container mx-auto flex flex-row justify-between items-center"><div class="flex items-center space-x-3"><a href="/"><img src="/logo/logo.svg" class="w-[20px] h-[20px] max-w-[20px]" alt="World4AI Logo"></a>
      <span class="font-bold tracking-[5px] uppercase">World4AI</span></div>
    
    <button class="md:hidden" aria-label="hamburger-navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-more-vertical "><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg></button>

    
    <nav class="bg-white hidden md:block drop-shadow-md md:drop-shadow-none absolute md:relative right-2 top-full p-2 md:p-0 hidden"><div class="flex flex-col md:flex-row"><ul class="flex flex-col md:flex-row md:space-x-10 lg:space-x-20 text-sm"><li class="group relative"><a class="no-underline inline-block p-2 hover:bg-gray-100" href="/">Home</a>
              
            </li><li class="group relative"><a class="no-underline inline-block p-2 hover:bg-gray-100" href="/blocks/introduction">Blocks</a>
              <ul class="z-10 bg-white text-left whitespace-nowrap md:hidden md:group-hover:block md:absolute md:drop-shadow-lg"><li><a class="no-underline inline-block py-2 px-4 w-full hover:bg-gray-100" href="/blocks/introduction">Introduction</a>
                    </li><li><a class="no-underline inline-block py-2 px-4 w-full hover:bg-gray-100" href="/blocks/deep_learning/fundamentals/introduction">Deep Learning</a>
                    </li><li><a class="no-underline inline-block py-2 px-4 w-full hover:bg-gray-100" href="/blocks/reinforcement_learning/intuition/introduction">Reinforcement Learning</a>
                    </li>
                </ul>
            </li><li class="group relative"><a class="no-underline inline-block p-2 hover:bg-gray-100" href="/sponsor">Sponsor</a>
              
            </li><li class="group relative"><a class="no-underline inline-block p-2 hover:bg-gray-100" href="/about">About</a>
              
            </li></ul>
        <div class="flex justify-center items-center gap-2 ml-6"><a href="https://github.com/World4AI" target="_blank" rel="noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-github "><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a>
          <a href="https://twitter.com/World4AI" target="_blank" rel="noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-twitter "><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path></svg></a></div></div></nav></div></header>
<div class="container mx-auto mb-2"><div class="py-2 xl:hidden sticky top-12 left-0 right-0 z-50"><button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div>

  <div class="xl:hidden hidden"><aside class="bg-gray-100 select-none border-r sticky top-[53px] left-0 max-h-[92vh] overflow-y-auto z-40 svelte-guid7z"><nav class="p-4"><h6 class="font-bold text-sm">Intuition</h6>
      <ul class="text-sm mb-4"><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/introduction">Introduction</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/applications">Applications</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/agent_environment">Agent and Environment</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/definition">Definition of RL</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/states_actions_rewards">States, Actions, Rewards</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/exploration_exploitation_dilemma">Exploration vs Exploitation</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/value_policy_model">Value, Policy, Model</a>
          </li>
      </ul><h6 class="font-bold text-sm">Markov Decision Process</h6>
      <ul class="text-sm mb-4"><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/markov_decision_process/introduction">Introduction</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/markov_decision_process/definition">Definition</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/markov_decision_process/solution">Solution</a>
          </li>
      </ul><h6 class="font-bold text-sm">Dynamic Programming</h6>
      <ul class="text-sm mb-4"><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/dynamic_programming/introduction">Introduction</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200 border-red-400" href="/blocks/reinforcement_learning/dynamic_programming/policy_iteration">Policy Iteration</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/dynamic_programming/value_iteration">Value Iteration</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/dynamic_programming/generalized_policy_iteration">Generalized Policy Iteration</a>
          </li>
      </ul></nav>
</aside></div>
  <div class="xl:grid xl:grid-cols-5 gap-2"><div class="hidden xl:block"><aside class="bg-gray-100 select-none border-r sticky top-[53px] left-0 max-h-[92vh] overflow-y-auto z-40 svelte-guid7z"><nav class="p-4"><h6 class="font-bold text-sm">Intuition</h6>
      <ul class="text-sm mb-4"><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/introduction">Introduction</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/applications">Applications</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/agent_environment">Agent and Environment</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/definition">Definition of RL</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/states_actions_rewards">States, Actions, Rewards</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/exploration_exploitation_dilemma">Exploration vs Exploitation</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/intuition/value_policy_model">Value, Policy, Model</a>
          </li>
      </ul><h6 class="font-bold text-sm">Markov Decision Process</h6>
      <ul class="text-sm mb-4"><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/markov_decision_process/introduction">Introduction</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/markov_decision_process/definition">Definition</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/markov_decision_process/solution">Solution</a>
          </li>
      </ul><h6 class="font-bold text-sm">Dynamic Programming</h6>
      <ul class="text-sm mb-4"><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/dynamic_programming/introduction">Introduction</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200 border-red-400" href="/blocks/reinforcement_learning/dynamic_programming/policy_iteration">Policy Iteration</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/dynamic_programming/value_iteration">Value Iteration</a>
          </li><li><a class="no-underline border-l inline-block py-2 px-4 w-full hover:bg-gray-200" href="/blocks/reinforcement_learning/dynamic_programming/generalized_policy_iteration">Generalized Policy Iteration</a>
          </li>
      </ul></nav>
</aside></div>
    <main class="lg:col-span-4"><article>

<h1>Policy Iteration</h1>
<div class="separator"></div>

<div class="container mx-auto" style="max-width: 1000px"><p>Dynamic programming algorithms that are designed to solve a Markov decision
    process are iterative algorithms, which consist of two basic steps: policy
    evaluation and policy improvement. The purpose of policy evaluation is to
    measure the performance of a given policy <span class="hidden">\pi</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


    by estimating the corresponding value function <span class="hidden">v_{\pi}(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


    . Policy improvement on the other hand generates a new policy, that is better
    (or at least not worse) than the previous policy. The output of policy evaluation
    is used as an input into policy improvement and vice versa. The iterative process
    of evaluation and improvement produces value and policy functions that converge
    towards the optimal policy function <span class="hidden">\pi_*</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and optimal
    value function <span class="hidden">v_*</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 over time. The policy iteration
    algorithm that is covered in this section is one such iterative algorithm.
  </p>
  <div class="separator"></div>

  <h2>Policy Evaluation</h2>
  <p>The goal of policy evaluation is to find the true value function <span class="hidden">v_{\pi}</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


    of the policy <span class="hidden">\pi</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

.
  </p>
  <span class="hidden">
    \begin{aligned}
   v_{\pi}(s)  &amp; = \mathbb{E}_{\pi}[R_{t+1} + \gamma v_{\pi}(s') \mid S_t=s] \\
&amp; = \sum_a \pi(a \mid s)  R(a, s) + \gamma \sum_a \pi(a \mid s) \sum_{s'} P(s' \mid s, a)v_{\pi}(s')
\end{aligned}
</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


  <p>Often it is more convenient to use the joint probability of simultaneously
    getting the reward <span class="hidden">r</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and the next state <span class="hidden">s&#39;</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 given
    current state <span class="hidden">s</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and action <span class="hidden">a</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

. This joint
    probability function is depicted as <span class="hidden">p(s&#39;, r \mid s, a)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

. This
    notation is more compact and is likely to make the transition from theory to
    practice easier.
  </p>
  <span class="hidden">
    \begin{aligned}
    v_{\pi}(s) &amp; = \mathbb{E}_{\pi}[R_{t+1} + \gamma v_{\pi}(S_{t+1}) \mid S_t = s] \\
    &amp; = \sum_a \pi(a \mid s)  R(a, s) + \gamma \sum_a \pi(a \mid s) \sum_{s'} P(s' \mid s, a)v_{\pi}(s') \\
    &amp; = \sum_{a}\pi(a \mid s)\sum_{s', r}p(s', r \mid s, a)[r + \gamma v_{\pi}(s')]
    \end{aligned}
  </span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


  <p>If we look closely at the Bellman equation, we can observe that the equation
    basically consists of two sides. The left side and the right side.
  </p>
  <span class="hidden">\underbrace{v_{\pi}(s)}_{\text{left side}} = \underbrace{\sum_{a}\pi(a \mid s)\sum_{s', r}p(s', r \mid s, a)[r + \gamma v_{\pi}(s')]}_{\text{right side}}</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


  <p>The left side is the function that returns the value of a state <span class="hidden">s</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

, it is the mapping from states to values. The left side is essentially the
    function we are trying to find. The right side is the definition of the
    value function, that is based on the expectation of the returns and is
    expressed using the Bellman equation.
  </p>
  <p>When we initialize the policy evaluation algorithm, the first step is to
    generate a value function that is used as a benchmark that needs to be
    constantly improved in the interative process. The initial values are set
    either randomly or to zero. When we start to use the above equation we will
    not surprisingly discover that the random/zero value (the left side of the
    above equation) and the expected value of the reward plus value for the next
    state (the right side of the above equation) will diverge quite a lot. The
    goal of the policy evaluation algorithm is to make the left side of the
    equation and the right side of the equation to be exactly equal. That is
    done in an iterative process where at each step the difference between both
    sides is reduced. In practice we do not expect the difference between the
    two to go all the way down to zero. Instead we define a threshold value. For
    example a threshold value of 0.0001 indicates that we can interrupt the
    iterative process as soon as for all the states <span class="hidden">s \in \mathcal{S}</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 the difference between the left and the right side of the equation is below
    the threshold value.
  </p>
  <p>The policy estimation algorithm is relatively straightforward. All we need
    to do is to turn the definition of the of the Bellman equation into the
    update rule.
  </p>
  <span class="hidden">V_{k+1}(s) = \sum_a \pi(a \mid s) \sum_{s', r}p(s', r \mid s, a)[r + \gamma V_{k}(s')]</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


  <p>Above we use <span class="hidden">V(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 instead of
    <span class="hidden">v(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

. This notational difference is to show that <span class="hidden">v(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 is the true value function of a policy <span class="hidden">\pi</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

, while <span class="hidden">V(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 is it&#39;s estimate. At each iteration step <span class="hidden">k+1</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 the left side of
    the equation (the esimate of the value function) is replaced by the right hand
    of the equation. At this point it should become apparent why the Bellman equation
    is useful. Only the reward from the next time step is required to improve the
    approximation, because all subsequent rewards are already condensed into the
    value function from the next time step. That allows the algorithm to use the
    model to look only one step into the future for the reward and use the approximated
    value function for the next time step. By repeating the update rule over and
    over again the rewards are getting embedded into the value function and the approximation
    gets better and better.
  </p>
  <p class="info">The process of using past estimates to improve current estimates is called
    <strong>bootstrapping</strong>. Bootstrapping is used heavily through
    reinforcement learning and can generally be used without the full knowledge
    of the model of the environment.
  </p>
  <p>Below you can find the Python implementation of the policy evaluation
    algorithm.
  </p>
  <p>Once again below we deal with a simple grid world where the task is to
    arrive at the bottom left corner starting from the top left corner. The
    environment transitions with 50% probability into the desired direction
    (unless there is some barrier) and with 50% chance the environment takes a
    randomm action. The playground below allows you to calculate the value
    function for a randomly initialized deterministic policy, using the policy
    evaluation algorithm. You can switch between the display of the policy and
    the value function. Start by taking one step of the algorithm at the time
    and observe how the value function propagates and the difference between
    steps keeps decreasing. Finally you can run the full policy evaluation
    algorithm, where the iterative process keeps going until the difference
    betwenn the left and the right side of the Bellman equation is less than
    0.00001.
  </p>
  <div class="flex-space"><div class="w-full"><div style="max-width: 500px;" class="my-0 mx-auto"><svg version="1.1" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg"><g id="grid">
        <rect stroke-width="0.3" x="0" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="40" y1="50" x2="62" y2="50" transform="rotate(180, 50, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="100" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="50" x2="162" y2="50" transform="rotate(0, 150, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="50" x2="262" y2="50" transform="rotate(270, 250, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="50" x2="362" y2="50" transform="rotate(180, 350, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="50" x2="462" y2="50" transform="rotate(180, 450, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="40" y1="150" x2="62" y2="150" transform="rotate(180, 50, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="100" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="150" x2="162" y2="150" transform="rotate(90, 150, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="150" x2="262" y2="150" transform="rotate(270, 250, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="150" x2="362" y2="150" transform="rotate(180, 350, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="150" x2="462" y2="150" transform="rotate(0, 450, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          <rect stroke-width="3" x="10" y="210" width="80" height="80" class="fill-red-400 stroke-black"></rect>

          
          

          
          
        <rect stroke-width="0.3" x="100" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          <rect stroke-width="3" x="110" y="210" width="80" height="80" class="fill-red-400 stroke-black"></rect>

          
          

          
          
        <rect stroke-width="0.3" x="200" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          <rect stroke-width="3" x="210" y="210" width="80" height="80" class="fill-red-400 stroke-black"></rect>

          
          

          
          
        <rect stroke-width="0.3" x="300" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="250" x2="362" y2="250" transform="rotate(0, 350, 250)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="250" x2="462" y2="250" transform="rotate(90, 450, 250)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="40" y1="350" x2="62" y2="350" transform="rotate(90, 50, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="100" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="350" x2="162" y2="350" transform="rotate(0, 150, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="350" x2="262" y2="350" transform="rotate(180, 250, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="350" x2="362" y2="350" transform="rotate(270, 350, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="350" x2="462" y2="350" transform="rotate(270, 450, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          <polygon stroke="black" class="fill-blue-400" stroke-width="2" points="50,440                     60,460                     40,460"></polygon>

          
          
        <rect stroke-width="0.3" x="100" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="450" x2="162" y2="450" transform="rotate(180, 150, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="450" x2="262" y2="450" transform="rotate(180, 250, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="450" x2="362" y2="450" transform="rotate(180, 350, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="450" x2="462" y2="450" transform="rotate(270, 450, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g></g></svg></div></div>
    <div class="flex-vertical"></div></div>

  <div class="separator"></div>

  <h2>Policy Improvement</h2>
  <p>The goal of policy improvement is to create a new and improved policy using
    the value function <span class="hidden">V(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 from the previous policy
    evaluation step.
  </p>
  <p>Let us assume for simplicity that the agent follows a deterministic policy <span class="hidden">\mu(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

, but in the current state <span class="hidden">s</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 the agent contemplates to pick the
    action <span class="hidden">a</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 that contradicts the policy, therefore
    <span class="hidden">a \neq \mu(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

. After that action the agent will
    stick to the old policy <span class="hidden">\mu(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and follow it until
    the terminal state <span class="hidden">T</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

. We can measure the value of using the
    action <span class="hidden">a</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 at state <span class="hidden">s</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and then following the policy
    <span class="hidden">\mu(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 using the action-value function.
  </p>
  <span class="hidden">q_{\mu}(s, a) \doteq \mathbb{E}[R_{t+1} + \gamma v_{\mu}(S_{t+1}) \mid S_t = s, A_t = a]</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


  <p>What if the agent compares the estimates <span class="hidden">V_{\mu}(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and <span class="hidden">Q_{\mu}(s, a)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


    and determines that taking some action <span class="hidden">a</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 and then following
    <span class="hidden">\mu</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 is of higher value than strictly following <span class="hidden">\mu</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

, showing that
    <span class="hidden">Q_{\mu}(s, a) > V_{\mu}(s)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

? Does that imply
    that the agent should change the policy and always take the action <span class="hidden">a</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


    when facing the state <span class="hidden">s</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

? Does the short term gain from the
    new action <span class="hidden">a</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 justifies changing the policy? It turns out that
    this is exactly the case.
  </p>
  <p>In the policy improvement step the we create a new policy <span class="hidden">\mu'</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

 where the agent chooses the greedy action at each state <span class="hidden">s \in \mathcal{S}</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>

.
  </p>
  <span class="hidden">\mu'(s) = \arg\max_a Q_{\mu}(s, a)</span>
<span class="inline-block px-0 py-[2px] md:whitespace-nowrap"><!-- HTML_TAG_START -->undefined<!-- HTML_TAG_END --></span>


  <p>Below you can find a Python example of the policy improvement step.</p>
  <div class="separator"></div>

  <h2>The Policy Iteration Algorithm</h2>
  <p>The idea of policy iteration is to alternate between policy evaluation and
    policy improvement until the optimal policy has been reached. Once the new
    policy and the old policy are exactly the same we have reached the optimal
    policy.
  </p>

  <p>Below is a playground from the same gridworld, that demonstrates the policy
    iteration algorithm. The algorithm finds the optimal policy and
    corresponding optimal value function, once you click on the <em>&quot;policy iteration&quot;</em> button.
  </p>
  <div class="flex-space"><div class="w-full"><div style="max-width: 500px;" class="my-0 mx-auto"><svg version="1.1" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg"><g id="grid">
        <rect stroke-width="0.3" x="0" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="40" y1="50" x2="62" y2="50" transform="rotate(180, 50, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="100" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="50" x2="162" y2="50" transform="rotate(0, 150, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="50" x2="262" y2="50" transform="rotate(270, 250, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="50" x2="362" y2="50" transform="rotate(180, 350, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="0" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="50" x2="462" y2="50" transform="rotate(180, 450, 50)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="40" y1="150" x2="62" y2="150" transform="rotate(180, 50, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="100" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="150" x2="162" y2="150" transform="rotate(90, 150, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="150" x2="262" y2="150" transform="rotate(270, 250, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="150" x2="362" y2="150" transform="rotate(180, 350, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="100" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="150" x2="462" y2="150" transform="rotate(0, 450, 150)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          <rect stroke-width="3" x="10" y="210" width="80" height="80" class="fill-red-400 stroke-black"></rect>

          
          

          
          
        <rect stroke-width="0.3" x="100" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          <rect stroke-width="3" x="110" y="210" width="80" height="80" class="fill-red-400 stroke-black"></rect>

          
          

          
          
        <rect stroke-width="0.3" x="200" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          <rect stroke-width="3" x="210" y="210" width="80" height="80" class="fill-red-400 stroke-black"></rect>

          
          

          
          
        <rect stroke-width="0.3" x="300" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="250" x2="362" y2="250" transform="rotate(0, 350, 250)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="200" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="250" x2="462" y2="250" transform="rotate(90, 450, 250)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="40" y1="350" x2="62" y2="350" transform="rotate(90, 50, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="100" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="350" x2="162" y2="350" transform="rotate(0, 150, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="350" x2="262" y2="350" transform="rotate(180, 250, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="350" x2="362" y2="350" transform="rotate(270, 350, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="300" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="350" x2="462" y2="350" transform="rotate(270, 450, 350)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="0" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          <polygon stroke="black" class="fill-blue-400" stroke-width="2" points="50,440                     60,460                     40,460"></polygon>

          
          
        <rect stroke-width="0.3" x="100" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="140" y1="450" x2="162" y2="450" transform="rotate(180, 150, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="200" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="240" y1="450" x2="262" y2="450" transform="rotate(180, 250, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="300" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="340" y1="450" x2="362" y2="450" transform="rotate(180, 350, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g>
        <rect stroke-width="0.3" x="400" y="400" width="100" height="100" class="fill-gray-600 stroke-white"></rect>

        
        
        

        
        

        
          

          
          

          
          <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto" class="fill-white"><polygon points="0 0, 5 3.5, 0 7"></polygon></marker></defs>
            <g><line x1="440" y1="450" x2="462" y2="450" transform="rotate(270, 450, 450)" class="stroke-white" stroke-width="1.2" marker-end="url(#arrowhead)"></line></g></g></svg></div></div>
    <div class="flex-vertical"></div></div>
  <div class="separator"></div></div></article>
      <div class="container mx-auto flex justify-between"><a aria-label="previous-page" href="/blocks/reinforcement_learning/dynamic_programming/introduction"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-arrow-left-circle "><circle cx="12" cy="12" r="10"></circle><polyline points="12 8 8 12 12 16"></polyline><line x1="16" x2="8" y1="12" y2="12"></line></svg></a>
  <a aria-label="next-page" href="/blocks/reinforcement_learning/dynamic_programming/value_iteration"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-arrow-right-circle "><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" x2="16" y1="12" y2="12"></line></svg></a></div></main></div></div>


			
			<script>
				{
					__sveltekit_w0xmvm = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null,null];

					Promise.all([
						import("../../../_app/immutable/entry/start.0686d7cc.js"),
						import("../../../_app/immutable/entry/app.bbaaaf6b.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 87],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
